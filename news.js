(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function N(e){const t={update(n){this.lastData!==n&&(r(n),this.lastData=n)},callback:n=>{}};return t;function r(n){e.innerText="",n.map(s=>{const a=document.createElement("details");a.classList.add("details");const l=document.createElement("summary");l.appendChild(i(s,"level0")),a.appendChild(l);for(let o of s.children)a.appendChild(i(o,"level1",I));return a}).forEach(s=>{e.appendChild(s)})}function i(n,s,a){const l=document.createElement("a");return l.href="#",l.classList.add(s),l.appendChild(document.createTextNode(((a==null?void 0:a(n.key))??n.key)+" ("+n.count+")")),l.addEventListener("click",()=>(t.callback(n.firstId),!1)),l}}function I(e){return months[e-1]}function z(e,t,r){e.innerHTML=`
        <p><label for="nf_page-size">${pageSizeTitle}:</label> <input id="nf_page-size" type="number" min="1" max="100" step="1" value="${t}"
                onkeypress='return event.charCode >= 48 && event.charCode <= 57'/></p>
        <p>${eventTypesTitle}: </p>
        <div id="nf_event-types"></div>
        <p><button id="nf_apply-filter" disabled="true">${applyFilterTitle}</button></p>        
    `;const i=e.querySelector("#nf_page-size"),n=e.querySelector("#nf_apply-filter"),s=e.querySelector("#nf_event-types"),a=o=>{const c=i.valueAsNumber;if(o.target===i&&c===l.pageSize){n.disabled=!0;return}if(c>0&&c<=100){const p=s.querySelectorAll("input");for(let d=0;d<p.length;d++)if(p[d].checked){n.disabled=!1,l.updateTotal();return}}n.disabled=!0},l={pageSize:t,filter:void 0,newsRequest(){return{pageSize:this.pageSize,filter:this.filter}},setPossibleTypes(o){s.innerHTML=T(o.types,w(!1))+T(o.extraTypes,w(!0)),s.querySelectorAll("input").forEach(c=>c.addEventListener("change",a)),this.typeCounter=new Map([...o.types,...o.extraTypes]),this.updateTotal()},updateFilter(){const o=s.querySelectorAll("input"),c=[],p=[];for(const d of o)d.checked&&(d.getAttribute("data-ext")==="true"?p.push(d.value):c.push(d.value));this.filter={types:c,extraTypes:p}},updateTotal(){var p;let o=0;const c=s.querySelectorAll("input");for(const d of c)d.checked&&(o+=((p=this.typeCounter)==null?void 0:p.get(d.value))??0);n.innerText=applyFilterTitle+" ("+o+")"},updatePageSize(){this.pageSize=i.valueAsNumber}};return n.addEventListener("click",function(){this.disabled=!0,l.updateFilter(),l.updatePageSize(),r(l.newsRequest())}),i.addEventListener("change",a),l}function w(e){return(t,r)=>`<p><input data-ext="${e}" type="checkbox" checked value="${t}">${typeNames.get(t)??t} (${r})</input></p>`}function T(e,t){const r=typeNames.keys(),i=[];for(const n of r)e.has(n)&&i.push(t(n,e.get(n)));return i.join("")}function b(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var g,h=news,m;const L=Math.floor;(()=>{for(var e=0;e<news.length;e++)news[e].id=news.length-e;m=C(news)})();function $(e,t){e.innerHTML=F(t)}function k(e){return`news${e}`}function F(e){const t=A();return e.map(r=>`
        <article>
            <div class="anchor" id="${k(r.id)}"></div>
            <header>
                <p>${t(r.time)}</p>
                <h1>${r.title}</h1>
            </header>
            <div>
            ${r.content}
            </div>
            <div style='clear:both'></div>
        </article>`).join("")}function A(){const e={year:"numeric",month:"numeric",day:"numeric"},t=Object.assign({hour:"2-digit",minute:"2-digit"},e);return r=>{let i=new Date(r);return r.length===10||r.indexOf("00:00")!==-1?i.toLocaleDateString(locale,e):i.toLocaleString(locale,t)}}function E(e){return O(e.filter)?(R(e.filter),!0):!1}function M(e,t){return q(e,t,E(t))}function q(e,t,r){const i=e*t.pageSize;return{page:e,total:h.length,filtered:r,news:h.slice(i,i+t.pageSize),calendar:m}}function _(e,t){const r=E(t);for(let i=0;i<h.length;i++)if(h[i].id===e){const n=L(i/t.pageSize);return q(n,t,r)}return null}function O(e){return g===void 0?e!==void 0:e===void 0?!0:!b(g.types,e.types)||!b(g.extraTypes,e.extraTypes)}function R(e){g=e,h=D(e),m=C(h)}function D(e){return e===void 0?news:news.filter(t=>{if(t.extra!==void 0){if(!e.extraTypes.includes(t.extra.type))return!1}else if(!e.types.includes(t.type))return!1;return!0})}function H(){const e={types:new Map,extraTypes:new Map};return news.forEach(t=>{t.extra!==void 0?S(e.extraTypes,t.extra.type):S(e.types,t.type)}),e}function S(e,t){let r=e.get(t);r===void 0&&(r=0),e.set(t,r+1)}function C(e){const t=[];for(let r of e){const i=parseInt(r.time.substring(0,4)),n=parseInt(r.time.substring(5,7)),s=P(t,i,r.id);s.children===void 0&&(s.children=[]),P(s.children,n,r.id)}return t}function P(e,t,r){if(e.length===0||e[e.length-1].key!==t){const n={key:t,firstId:r,count:1};return e.push(n),n}const i=e[e.length-1];return i.count++,i}function x(e){const t=y("«"),r=y("»"),i={lastPage:-1,lastTotal:0,page(){return this.lastPage},update(n,s){this.lastTotal!=s?this.reinit(n,s):this.changePage(n)},changePage(n){if(n!=this.lastPage){const s=e.querySelectorAll("a");s[n+1].classList.toggle("active"),s[this.lastPage+1].classList.toggle("active"),this.lastPage=n}},reinit(n,s){e.textContent="",e.appendChild(t);for(let a=0;a<s;a++){const l=y((a+1).toString());a==n&&l.classList.add("active"),e.appendChild(l),l.addEventListener("click",()=>(this.callback(a),!1))}e.appendChild(r),this.lastPage=n,this.lastTotal=s},prev(){this.lastPage>0&&this.callback(this.lastPage-1)},next(){this.lastPage<this.lastTotal-1&&this.callback(this.lastPage+1)},callback:n=>{}};return t.addEventListener("click",()=>(i.prev(),!1)),r.addEventListener("click",()=>(i.next(),!1)),i}function y(e){const t=document.createElement("a");return t.href="#",t.appendChild(document.createTextNode(e)),t}document.querySelector("#app").innerHTML=`
    <header class="pager" id="top-pager"></header>
    <section class="blog-news">
        <aside class="left-panel">
            <details>
                <summary><span class="level0">${filterTitle}</span></summary>
                <div class="filter" id="news-filter"></div>            
            </details>
            <h3>${newsTotalTitle}: <span id="total-count"></span></h3>
            <div id="news-calendar"></div>
        </aside>
        <main id="news"></main>
    </section>
    <header class="pager" id="bottom-pager"></header>
`;(()=>{const e=document.querySelector("#news"),t=x(document.querySelector("#top-pager")),r=x(document.querySelector("#bottom-pager")),i=document.querySelector("#total-count"),n=document.querySelector("#news-filter"),s=N(document.querySelector("#news-calendar"));s.callback=d;const a=5,l=u=>{if(u.filtered||t.page()!=u.page){i.innerText=u.total.toString();let f=L(u.total/c.pageSize);u.total%c.pageSize>0&&f++,t.update(u.page,f),r.update(u.page,f),$(e,u.news),s.update(u.calendar),setupImageViewer(openImageTitle)}},o=(u,f)=>{l(M(u,f))},c=z(n,a,u=>{o(0,u)});t.callback=u=>{o(u,c.newsRequest())},r.callback=t.callback;const p=V();p!==null?d(p):o(0,c.newsRequest()),c.setPossibleTypes(H());function d(u){const f=_(u,c.newsRequest());if(f!==null){let v=function(){document.getElementById(k(u)).scrollIntoView({behavior:"instant"})};l(f),document.readyState==="complete"?v():document.onreadystatechange=function(){document.readyState==="complete"&&v()}}else o(0,c.newsRequest())}})();function V(){const e=window.location.search,r=new URLSearchParams(e).get("news-id");return r!==null?parseInt(r):null}
