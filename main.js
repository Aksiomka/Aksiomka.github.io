"use strict";const{assign}=Object;var isUndefined=a=>a==void 0;function ImageViewer(){let img=document.createElement('img');img.className='image-viewer';let fullSizeLink=document.createElement('a');fullSizeLink.target='_blank';fullSizeLink.appendChild(document.createTextNode(''));let extLink=document.createElement('p');extLink.className='ext-link';extLink.appendChild(fullSizeLink);let wrapper=img;let curtain=document.createElement('div');curtain.className='curtain';curtain.appendChild(wrapper);curtain.appendChild(extLink);let loader=document.createElement('div');loader.className='loader';curtain.appendChild(loader);curtain.addEventListener('click',()=>curtain.remove());function startAnimation(){curtain.classList.add('active');setTimeout(()=>extLink.style='',400)}img.addEventListener('load',()=>{loader.style='display: none;';startAnimation()});img.addEventListener('error',event=>{console.log('Image load error',event);curtain.remove()});function init(href){curtain.classList.remove('active');extLink.style='visibility: hidden;';img.src=href;document.body.appendChild(curtain)}return{wrapper:wrapper,fullSizeLink:fullSizeLink,init:init,setTitle:function(title){this.fullSizeLink.firstChild.textContent=title}}}function setupImageViewer(openImageTitle,imageGroups){function middleImage(ref){let dirIdx=ref.lastIndexOf('/');let dotIdx=ref.lastIndexOf('.');return ref.substring(0,dirIdx)+'/preview'+ref.substring(dirIdx,dotIdx)+'_middle'+ref.substring(dotIdx)}let imageViewer=ImageViewer();let clickEvent=e=>{e.preventDefault();let el=e.target.closest('a.art-link');let posX=el.offsetLeft;let posY=el.offsetTop;let wr=imageViewer.wrapper;wr.style.left=`${posX}px`;wr.style.top=`${posY}px`;let size=el.dataset.size;let pixels=el.dataset.pixels;let title=openImageTitle;(size&&pixels)&&(title=title+' ('+pixels+', '+size+')');let fullSizeLink=imageViewer.fullSizeLink;fullSizeLink.title=title;let href;let group=el.dataset.group;if(!isUndefined(group)){let groupIdx=parseInt(group);let imageIdx=parseInt(el.dataset.idx);let imageGroup=imageGroups[groupIdx];let imageItem=imageGroup[imageIdx];href=imageItem.img;imageViewer.setTitle(imageItem.title);wr.alt=imageItem.alt}else{href=el.href;let img=el.querySelector('img');imageViewer.setTitle(img.title||img.alt||openImageTitle)}fullSizeLink.href=href;imageViewer.init(middleImage(href))};let images=document.getElementsByClassName('art-link');for(const el of images)el.addEventListener('click',clickEvent)}function storageChecker(itemName,handleTrue,handleFalse,defaultPreference){return{itemName:itemName,handleTrue:handleTrue,handleFalse:handleFalse,defaultPreference:defaultPreference,turnTrue:function(){this.handleTrue();this.store(!0)},turnFalse:function(){this.handleFalse();this.store(!1)},isTrue:function(){var value=window.localStorage.getItem(this.itemName);if(value===null)return this.defaultPreference();return value==='1'},store:function(value){var preffered=this.defaultPreference(),needToSave=(value===!0&&!preffered)||(value===!1&&preffered);if(needToSave){var newValue=value===!0?'1':'0';window.localStorage.setItem(this.itemName,newValue)}else{var oldValue=window.localStorage.getItem(this.itemName);oldValue!==null&&this.remove()}},remove:function(){window.localStorage.removeItem(this.itemName)},restore:function(){this.isTrue()?this.handleTrue():this.handleFalse()}}}function preferesEn(){return!navigator.language.startsWith('ru')}function redirectLang(eng){return ()=>{var path=window.location.pathname;window.location.replace(eng?path.replace('/ru/','/en/'):path.replace('/en/','/ru/'))}}function changeLanguage(){var path=window.location.pathname,eng=path.indexOf('/en/')!==-1,lang=storageChecker('lang',redirectLang(!0),redirectLang(!1),preferesEn);lang.store(!eng);lang.restore()}function renderPostTime(locale){let list=document.getElementsByClassName('post-time');let optDate={year:'numeric',month:'numeric',day:'numeric'};let optWithTime=assign({hour:'2-digit', minute:'2-digit'},optDate);for(let el of list){date=new Date(el.dateTime);el.innerHTML=el.dateTime.length===10||el.dateTime.indexOf('00:00')!==-1?date.toLocaleDateString(locale,optDate):date.toLocaleString(locale,optWithTime)}}function redirect(location){window.location.replace(location)}function metrika(){(function(m,e,t,r,i,k,a){m[i]=m[i]||function(...args){(m[i].a=m[i].a||[]).push(args)};m[i].l=1*new Date;for(var j=0;j<document.scripts.length;j++)if(document.scripts[j].src===r)return;k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window,document,'script','https://mc.yandex.ru/metrika/tag.js','ym');ym(100534172,'init',{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})}